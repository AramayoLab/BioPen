<!DOCTYPE html>
<html lang="en">
	<head>
		<title>OrbitusBiomedical - âˆ‚ipole</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<meta http-equiv="X-Frame-Options" content="ALLOWALL">
		<link href="css/bootstrap.css" rel="stylesheet">
    	<link href="css/bootstrap-responsive.css" rel="stylesheet">
		<link href="css/jquery-ui.css" rel="stylesheet">
    	<link href="css/PubChemExample.css" rel="stylesheet">
		<style>
			


		</style>
	</head>
	<body>

		<div id="webgl_div" style="width:100%; height:100%; ">
		</div>

		<div id="searchContainer">
			<form id="pubChemSearchForm" onSubmit="return checkField()">
				<input id="field" name="field" type="text" />
				<div id="delete"><span id="x">x</span></div>
				<input id="submitButton" name="submit" type="button" value="Search" />
				<div id="outputbox">
			    	<p id="outputcontent"></p>
				</div>
			</form>
		</div>

        <div id="molecule_details">
					

				<label id="MoleculeName">Water</label>
				<h4>Molecular Formula: <label id="MoleculeFormula">H2O</label></h4>
				<div>
					<label>
						<span>CID: <label id="MoleculeCID">0000</label></span>
						
					</label>
				</div>
				<div>
					<label>
						<span>IUPAC Preferred Name: <label id="IUPAC_PreferredName">oxidane</label></span>
						
					</label>
				</div>
				<div>
					<label>
						<span>Molecular Weight: <label id="MolecularWeight">18.010565</label> g/mol</span>
						
					</label>
				</div>
				<div>
					<label>
						<span>RotatableBond: <label id="RotatableBond">1</label></span>
						
					</label>
				</div>
				<div>
					<label>
						<span>Hydrogen Bond Acceptor: <label id="HydrogenBondAcceptor">0</label></span>
					</label>
				</div>
				<div>
					<label>
						<span>Hydrogen Bond Donor: <label id="HydrogenBondDonor">0</label></span>
						
					</label>
				</div>
				<div>
					
				</div>
		</div>

		<label id="MoleculeName_MainLabel"></label>


		<script>
	        /*
	         * Initialize the global objects we will need.
	         */
	        if(typeof CKCatalog === 'undefined') {
	            CKCatalog = {};
	        }

	        if(typeof CKCatalog.tabs === 'undefined') {
	            CKCatalog.tabs = {
	                'readme': [{}],
	                'not-found': [{}]
	            };
	        }

	        //log the parameter pushed into the html line
	        var param1var = getQueryVariable("uuid");
	        console.log("Parameter: " + param1var);

	        if (param1var == null)
	        {
	        	

	        	function generateUUID() {
				    var d = new Date().getTime();
				    if(window.performance && typeof window.performance.now === "function"){
				        d += performance.now();; //use high-precision timer if available
				    }
				    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
				        var r = (d + Math.random()*16)%16 | 0;
				        d = Math.floor(d/16);
				        return (c=='x' ? r : (r&0x3|0x8)).toString(16);
				    });
					console.log("creating new pen: " + uuid);
				    return uuid;
				};

				debugger;
				
	        	var zoneName = undefined;
	        	var recordName = generateUUID();
	        	var title = "title";
	        	var molecule = "ether";

	        	var container = CloudKit.getDefaultContainer();
				var publicDB = container.publicCloudDatabase;

				// If no options are provided the record will be saved to the default zone.
				var options = zoneName ? { zoneID: zoneName } : undefined;

				var record = {
					recordName: recordName,

					recordType: 'BioPen',

					fields: {
					  molecule: {
					    value: molecule
					  },
					  title: {
					    value: title
					  }
					}
				};

				publicDB.saveRecord(record,options)
				.then(function(response) {
				  if(response.hasErrors) {

				    // Handle the errors in your app.
				    throw response.errors[0];

				  } else {
				    var createdRecord = response.records[0];
				    var fields = createdRecord.fields;
				    var molecule = fields['molecule'];
				    var title = fields['title'];
				    
				    console.log("YourData = " + molecule + "; Title = " + title);
				  }
				});

	        }
	        else
	        {
	        	console.log("Load Pen: " + param1var);	
	        }

			function getQueryVariable(variable) {
			  var query = window.location.search.substring(1);
			  var vars = query.split("&");
			  for (var i=0;i<vars.length;i++) {
			    var pair = vars[i].split("=");
			    if (pair[0] == variable) {
			      return pair[1];
			    }
			  } 
			  //alert('Query Variable ' + variable + ' not found');
			}
	    </script>

		<script src="https://www.promisejs.org/polyfills/promise-6.1.0.js"></script>
	    <script src="https://autobahn.s3.amazonaws.com/autobahnjs/latest/autobahn.min.jgz"></script>
	    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	    <script src="js/realsense.js"></script>


		<script src="js/three.min.js"></script>

		<script src="js/controls/TrackballControls.js"></script>
		<script src="js/controls/DeviceOrientationControls.js"></script>
		<script src="js/controls/TransformControls.js"></script>

		<script src="js/effects/StereoEffect.js"></script>

		<script src="js/loaders/PubChem_3DJSONLoader.js"></script>
		<script src="js/loaders/PDBLoader.js"></script>
		
		<script src="js/libs/stats.min.js"></script>
		
		<script src="js/THREEx.KeyboardState.js"></script>
		<script src="js/THREEx.FullScreen.js"></script>
		<script src="js/THREEx.WindowResize.js"></script>

		<script src='js/threex.dilategeometry.js'></script>
		<script src='js/threex.atmospherematerial.js'></script>
		<script src="js/threex.geometricglowmesh.js"></script>

		<script src="js/jquery-2.1.0.js" ></script>
		<script src="js/jquery.blockUI.js" ></script>
		<script src="js/Detector.js"></script>
		
		<!--<script type="text/javascript" src="js/bootstrap.js"></script>
		<script type="text/javascript" src="js/bootstrap-tooltip.js"></script>
		<script type="text/javascript" src="js/bootstrap-confirmation.js"></script>		
		-->

		<script src="js/jquery-ui.js"></script>


		<script src="js/PubChemExample.js"></script>


		<script src="js/ui-utils/dialog.js"></script>
	    <script src="js/ui-utils/table.js"></script>
	    <script src="js/ui-utils/form.js"></script>
		<script src="js/authentication.js"></script>

	    <script src="js/discoverability.js"></script>
	    <script src="js/public-query.js"></script>
	    <script src="js/private-zones.js"></script>
	    <script src="js/private-records.js"></script>
	    <script src="js/private-sync.js"></script>
	    <script src="js/private-subscriptions.js"></script>
	    <script src="js/notifications.js"></script>
	    <script src="js/ui-utils/tab-manager.js"></script>
		<script src="js/init.js"></script>
	    <!--<script async src="https://cdn.apple-cloudkit.com/cloudkit-catalog/highlight.pack.js"
	            onload="CKCatalog.tabManager.initializeCodeHighlighting()">
	    </script>-->
	    <script>

	        window.addEventListener('cloudkitloaded',CKCatalog.init);
			

	    </script>
	    <script async src="https://cdn.apple-cloudkit.com/ck/1/cloudkit.js"></script>
		
	</body>
</html>
